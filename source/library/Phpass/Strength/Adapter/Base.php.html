<html>
    <head>
        <script
            type="text/javascript"
            src="../../../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * PHP Password Library
 *
 * @package PHPass
 * @subpackage Strength
 * @category Cryptography
 * @author Ryan Chouinard &lt;rchouinard at gmail.com&gt;
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @link https://github.com/rchouinard/phpass PHPass project at GitHub.
 */

/**
 * @namespace
 */
namespace Phpass\Strength\Adapter;
use Phpass\Strength\Adapter;

/**
 * PHPass Strength Adapter Base Class
 *
 * @package PHPass
 * @subpackage Strength
 * @category Cryptography
 * @author Ryan Chouinard &lt;rchouinard at gmail.com&gt;
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @link https://github.com/rchouinard/phpass PHPass project at GitHub.
 */
abstract class Base implements Adapter
{

    const CLASS_LETTER = 'letter';
    const CLASS_UPPER = 'upper';
    const CLASS_LOWER = 'lower';
    const CLASS_NUMBER = 'number';
    const CLASS_SYMBOL = 'symbol';

    /**
     * Password string to analyze.
     *
     * @var string
     */
    protected $_password;

    /**
     * Calculated strength score.
     *
     * @var integer
     */
    protected $_score;

    /**
     * Password string length in bytes.
     *
     * @var integer
     */
    protected $_length;

    /**
     * Map of the number of times tokens appear in the password string.
     *
     * @var array
     */
    protected $_tokens;

    /**
     * Map of indices pointing to token class in the password string.
     *
     * @var array
     */
    protected $_tokenIndices;

    /**
     * Map of the number of times a token class occurs in the password string.
     *
     * @var array
     */
    protected $_tokenCounts;

    /**
     * Analyze a password string and store relevant metadata.
     *
     * @param string $password
     *   The password string to analyze.
     * @return void
     */
    protected function _analyze($password)
    {
        // Reset the class
        $this-&gt;_password = $password;
        $this-&gt;_score = 0;
        $this-&gt;_length = strlen($password);
        $this-&gt;_tokens = array ();
        $this-&gt;_tokenCounts = array (
            self::CLASS_LETTER =&gt; 0,
            self::CLASS_UPPER =&gt; 0,
            self::CLASS_LOWER =&gt; 0,
            self::CLASS_NUMBER =&gt; 0,
            self::CLASS_SYMBOL =&gt; 0
        );
        $this-&gt;_tokenIndices = array (
            self::CLASS_LETTER =&gt; array (),
            self::CLASS_UPPER =&gt; array (),
            self::CLASS_LOWER =&gt; array (),
            self::CLASS_NUMBER =&gt; array (),
            self::CLASS_SYMBOL =&gt; array ()
        );

        $this-&gt;_parseTokens();
    }

    /**
     * Tokenize the password string.
     *
     * @return void
     */
    protected function _parseTokens()
    {
        for ($index = 0; $index &lt; $this-&gt;_length; ++$index) {
            $token = $this-&gt;_password[$index];
            $tokenAsciiValue = ord($token);

            if ($tokenAsciiValue &gt;= 48 &amp;&amp; $tokenAsciiValue &lt;= 57) {
                $tokenClass = self::CLASS_NUMBER;
            } else if ($tokenAsciiValue &gt;= 65 &amp;&amp; $tokenAsciiValue &lt;= 90) {
                $tokenClass = self::CLASS_UPPER;
            } else if ($tokenAsciiValue &gt;= 97 &amp;&amp; $tokenAsciiValue &lt;= 122) {
                $tokenClass = self::CLASS_LOWER;
            } else {
                $tokenClass = self::CLASS_SYMBOL;
            }

            // Track the number and index of tokens belonging to class
            ++$this-&gt;_tokenCounts[$tokenClass];
            $this-&gt;_tokenIndices[$tokenClass][] = $index;

            // Members of UPPER and LOWER also belong to LETTER...
            if ($tokenClass == self::CLASS_UPPER || $tokenClass == self::CLASS_LOWER) {
                ++$this-&gt;_tokenCounts[self::CLASS_LETTER];
                $this-&gt;_tokenIndices[self::CLASS_LETTER][] = $index;
            }

            // Track the number of times this token appears
            if (array_key_exists($token, $this-&gt;_tokens)) {
                $this-&gt;_tokens[$token] += 1;
            } else {
                $this-&gt;_tokens[$token] = 1;
            }
        }
    }

    /**
     * Get an array of token indices within the password string for a given
     * class.
     *
     * @param string $class
     *   Token class to retrieve indices for.
     * @return array
     *   Returns a numerically indexed array of indicies where characters of a
     *   given class may be found in the password string.
     */
    protected function _getClassIndices($class)
    {
        $indices = array ();
        if (isset ($this-&gt;_tokenIndices[$class])) {
            $indices = $this-&gt;_tokenIndices[$class];
        }
        return $indices;
    }

    /**
     * Get a token count within the password string for a given class.
     *
     * @param string $class
     *   Token class to retrieve count for.
     * @return integer
     *   Returns the total number of characters of a given class which are in
     *   the password string.
     */
    protected function _getClassCount($class)
    {
        $count = 0;
        if (isset ($this-&gt;_tokenCounts[$class])) {
            $count = $this-&gt;_tokenCounts[$class];
        }
        return $count;
    }

}</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>