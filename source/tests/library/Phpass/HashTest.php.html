<html>
    <head>
        <script
            type="text/javascript"
            src="../../../../js/jquery-1.4.2.min.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shCore.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushJScript.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushPhp.js">
        </script>
        <script
            type="text/javascript"
            src="../../../../syntax_highlighter/scripts/shBrushXml.js">
        </script>
        <link
            href="../../../../syntax_highlighter/styles/shCore.css" rel="stylesheet"
            type="text/css"
        />
        <link
            href="../../../../syntax_highlighter/styles/shCoreEclipse.css"
            rel="stylesheet" type="text/css"
        />
        <link
            href="../../../../syntax_highlighter/styles/shThemeWordpress.css"
            rel="stylesheet" type="text/css"
        />
    </head>
    <body>
        <pre class="brush: php">&lt;?php
/**
 * PHP Password Library
 *
 * @package PHPass
 * @subpackage Tests
 * @category Cryptography
 * @author Ryan Chouinard &lt;rchouinard at gmail.com&gt;
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @link https://github.com/rchouinard/phpass PHPass project at GitHub.
 */

/**
 * @namespace
 */
namespace Phpass;

/**
 * PHP Password Library
 *
 * @package PHPass
 * @subpackage Tests
 * @category Cryptography
 * @author Ryan Chouinard &lt;rchouinard at gmail.com&gt;
 * @license http://www.opensource.org/licenses/mit-license.html MIT License
 * @link https://github.com/rchouinard/phpass PHPass project at GitHub.
 */
class HashTest extends \PHPUnit_Framework_TestCase
{

    /**
     * @test
     * @return void
     */
    public function defaultInstanceUsesBcryptAdapter()
    {
        $hash = new Hash;

        // Verify adapter instance
        $this-&gt;assertInstanceOf(
            'Phpass\\Hash\\Adapter\\Blowfish', // Expected
            $hash-&gt;getAdapter() // Actual
        );

        // Verify adapter configuration
        $property = new \ReflectionProperty('Phpass\\Hash\\Adapter\\Blowfish', '_iterationCountLog2');
        $property-&gt;setAccessible(true);
        $this-&gt;assertEquals(
            12, // Expected
            $property-&gt;getValue($hash-&gt;getAdapter()) // Actual
        );
    }

    /**
     * @test
     * @return void
     */
    public function passingAdapterViaConstructorCorrectlySetsInstance()
    {
        $adapter = new \Phpass\Hash\Adapter\Pbkdf2;
        $hash = new Hash($adapter);

        $this-&gt;assertInstanceOf(
            'Phpass\\Hash\\Adapter\\Pbkdf2', // Expected
            $hash-&gt;getAdapter() // Actual
        );
    }

    /**
     * @test
     * @return void
     */
    public function passingOptionsViaConstructorCorrectlySetsProperties()
    {
        $hash = new Hash(array (
            'adapter' =&gt; new \Phpass\Hash\Adapter\Pbkdf2,
            'hmacKey' =&gt; 'My53cr3tK3y',
            'hmacAlgo' =&gt; 'sha512'
        ));

        $this-&gt;assertInstanceOf(
            'Phpass\\Hash\\Adapter\\Pbkdf2', // Expected
            $hash-&gt;getAdapter() // Actual
        );

        $property = new \ReflectionProperty('Phpass\\Hash', '_hmacKey');
        $property-&gt;setAccessible(true);
        $this-&gt;assertEquals(
            'My53cr3tK3y', // Expected
            $property-&gt;getValue($hash) // Actual
        );

        $property = new \ReflectionProperty('Phpass\\Hash', '_hmacAlgo');
        $property-&gt;setAccessible(true);
        $this-&gt;assertEquals(
            'sha512', // Expected
            $property-&gt;getValue($hash) // Actual
        );
    }

    /**
     * @test
     * @return void
     */
    public function hashPasswordMethodReturnsDifferentHashGivenSameInput()
    {
        $password = 'password';
        $hash = new Hash;

        $passwordHash = $hash-&gt;hashPassword($password);
        $this-&gt;assertEquals('$2a$', substr($passwordHash, 0, 4));
        $this-&gt;assertTrue($hash-&gt;checkPassword($password, $passwordHash));

        $oldPasswordHash = $passwordHash;
        $passwordHash = $hash-&gt;hashPassword($password);
        $this-&gt;assertNotEquals($passwordHash, $oldPasswordHash);
        $this-&gt;assertEquals('$2a$', substr($passwordHash, 0, 4));
        $this-&gt;assertTrue($hash-&gt;checkPassword($password, $passwordHash));
    }

    /**
     * @test
     * @return void
     */
    public function hashPasswordMethodUsesHmacIfSoConfigured()
    {
        $password = 'password';
        $hmacKey = 'My53cr3tK3y';

        // Generate and confirm a non-HMAC hash.
        $hash = new Hash;
        $standardPasswordHash = $hash-&gt;hashPassword($password);
        $this-&gt;assertTrue($hash-&gt;checkPassword($password, $standardPasswordHash));

        // Generate and confirm an HMAC hash.
        $hmacHash = new Hash(array ('hmacKey' =&gt; $hmacKey));
        $hmacPasswordHash = $hmacHash-&gt;hashPassword($password);
        $this-&gt;assertTrue($hmacHash-&gt;checkPassword($password, $hmacPasswordHash));

        // Non-HMAC hash should not verify with HMAC-configured instance,
        // even given the same password input.
        $this-&gt;assertFalse($hmacHash-&gt;checkPassword($password, $standardPasswordHash));
        $this-&gt;assertFalse($hash-&gt;checkPassword($password, $hmacPasswordHash));
    }

}</pre>
        <script type="text/javascript">
             SyntaxHighlighter.all()
             jQuery('.gutter div').each(function(key, data){
                jQuery(data).prepend('<a name="L'+jQuery(data).text()+'"/>');
             });
        </script>
    </body>
</html>